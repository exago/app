<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-meta/iron-meta.html">
<link rel="import" href="../../bower_components/iron-signals/iron-signals.html">
<link rel="import" href="../../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../../bower_components/neon-animation/animations/fade-in-animation.html">

<link rel="import" href="../../bower_components/polymer-codemirror-go/code-mirror.html"/>

<link rel="import" href="../common-styles.html">

<script src="../../bower_components/underscore.string/dist/underscore.string.min.js"></script>
<script src="../../bower_components/blend.js/lib/blend.min.js"></script>

<dom-module id="code-displayer">
  <template>
    <style include="common-styles">
      :host {
        position: relative;
        display: block;
        @apply(--shadow-elevation-2dp);
        min-height: 70px;
      }
      :host paper-spinner {
        position: absolute;
        top: 20px;
        left: 50%;
      }
      #codeMirror {
        opacity: 0;
      }
    </style>

    <iron-meta id="meta"></iron-meta>
    <iron-signals on-iron-signal-lint="_lintSignal"></iron-signals>
    <iron-ajax id="codeRequest" handle-as="json" on-error="handleError" on-response="handleResponse"></iron-ajax>
    <paper-spinner active id="codeLoading"></paper-spinner>
    <code-mirror id="codeMirror" mode$="{{language}}" value$="{{content}}" readonly hidecursor>
    </code-mirror>
    <template is="dom-if" if="{{_error}}">
      <div class="Message">
        <iron-icon icon="error-outline"></iron-icon>
        <div class="Message-contents">
          <h2>Oops!</h2>
          <p>It seems something went wrong while we were fetching <em>{{repository}}/{{path}}</em>.</p>
          <p>The application received the following message:<br><em>{{_error}}</em></p>
        </div>
      </div>
    </template>
  </template>

  <script src="code-displayer.js"></script>

</dom-module>
