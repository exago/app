machine:
  node:
    version: 5.0
  environment:
    CONTINUOUS_INTEGRATION: true

dependencies:
  cache_directories:
    - node_modules
  override:
    - npm install

test:
  override:
    - npm run lint
    - npm test

deployment:
  release:
    branch: master
    commands:
      - npm run build
      - docker login -u $REGISTRY_USERNAME -p $REGISTRY_PASSWORD -e $REGISTRY_EMAIL
      - docker build -t exago/app:$TAG .
      - docker build -t exago/app:latest .
      - docker push exago/app
